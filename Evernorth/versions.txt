v1 - traditional implementation (without kafka)
